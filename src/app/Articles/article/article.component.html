<div class="container" id="main-container">
    <div class="row d-flex justify-content-center">
      <div class="col-md-6">
        <h1 style="font-family:Marker Felt, fantasy; font-size: 28px; color:midnightblue">Gestion des metiers</h1>
      </div>
    </div>
      <div class="row">
        <div class="col-md-4">
          <h2 style="font-family: Comic Sans MS; color: midnightblue;">Tou dabord choisissez un secteur d'activité</h2>
          <select ngModel (ngModelChange)="getSecteurChoisis($event)" name="secteur_d_activite" id="secteur_d_activite" class="form-select" placeholder="secteur_d_activite" aria-label="Default select example" required #secteur_d_activite="ngModel"  [class.is-invalid]="secteur_d_activite.invalid && secteur_d_activite.touched">
           <!-- <option selected>choisir un secteur</option>-->
            <option   *ngFor="let sect of secteurs"
            [value]="sect.id">
            {{sect.nomSecteur}}
          </option>
          </select>
        </div>
        <div *ngIf="secteur_d_activite.dirty" class="col-md-4">
         <div>
          <input type="search" [(ngModel)]="searchA" class="form-control" id="searchM" name="searchM"  placeholder="rechercher la metier par nom"> 
          <div>
            <h2 style="font-family: Comic Sans MS; color: midnightblue;">Liste  des articles disponibles</h2>
            <table class="table table-primary table-hover table-striped">
              <thead>
                <tr>
                  <th scope="col" class="bg-primary">#</th>
                  <th scope="col" class="bg-primary">Code</th>
                  <th scope="col" class="bg-primary">Designation</th>
                  <th scope="col" class="bg-primary">Unitee</th>
                  <th scope="col" class="bg-primary">Action</th>
                  <th scope="col" class="bg-primary"></th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let article of articles | filter:searchA | paginate : {
                    itemsPerPage:4,
                    currentPage:page,
                    totalItems:totalLength
                    }
                    ,let i= index">
                  <th scope="row">{{i}}</th>
                  <td>{{article.code}}</td>
                  <td>{{article.designation}}</td>
                  <td>{{article.unitee}}</td>
                  <td><button type="button" class="btn btn-success" (click)="onOpenDeleteMetierModal(article)"><i class="fa fa-pencil-square-o" aria-hidden="true"></i></button></td>
                  <td><button type="button" class="btn btn-danger" (click)="onOpenDeleteMetierModal(article)"><i class="fa fa-trash" aria-hidden="true"></i></button></td>
                  

                </tr>
              </tbody>
             
            </table>
            <pagination-controls (pageChange)="page = $event" class="text-center entreprisePagination"></pagination-controls>
        </div>
         </div>
         <h2 style="font-family: Comic Sans MS; color: midnightblue;">Liste  des metiers disponibles</h2>
         
        </div>
        <div *ngIf="secteur_d_activite.dirty" class="col-md-2">
          <button type="button" class="btn btn-primary" (click)="onOpenAddMetierModal()" style="background-color: navy;"><i class="fa fa-plus" aria-hidden="true"></i></button>
        </div>
      
    </div>
  
     <!-- Add Bonde Commande modal -->
     <div class="modal fade" id="addMetierModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h3 class="modal-title" id="exampleModalLongTitle">Ajouter un  nouveau metier</h3>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body">
              <form #addMetierForm="ngForm">
               <div>
                <label for="montant">Nom du metier</label>
                <input type="text"ngModel name="nomMetier"  class="form-control" id="nomMetier" placeholder="nom du nouveau metier" required>
              </div>
              <br>
              <div *ngIf="alerteNomMetierutilisee" class="alert alert-danger alert-dismissible fade show" role="alert">
                <strong>Attention</strong> nom du metier deja utilisee
                <button type="button" class="btn-close" (click)="closeAlert()" aria-label="Close"></button>
              </div>
              
                  <div class="modal-footer">
                     <button type="button" id="closeAjoutModal" class="btn btn-secondary" data-dismiss="modal">Fermer</button>
                     <button [disabled]="addMetierForm.invalid" type="submit" class="btn btn-primary" (click)="ajouterMetier(addMetierForm)"  style="background-color: navy;">Ajouter le metier</button>
                  </div>
                  </form>
          </div>
        </div>
      </div>
    </div>
  
  
     <!-- Add Bonde Commande modal -->
     <div class="modal fade" id="deleteMetierModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h3 class="modal-title" id="exampleModalLongTitle">Supprimer un metier</h3>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body">
            <h3>Voulez vous vraiment supprimer le metier  <h2 style="color: firebrick;">{{deletedMetier?.nomMetier}}</h2> du secteur d'activité  <h2 style="color: firebrick;">{{secteur?.nomSecteur}}</h2></h3>
              
                 
          </div>
          <div class="modal-footer">
            <button type="button" id="closeSuppressionModal" class="btn btn-secondary" data-dismiss="modal">Fermer</button>
            <button  type="button" class="btn btn-primary" (click)="supprimerMetier(deletedMetier.id)" style="background-color: firebrick;" >Supprimer</button>
         </div>
        </div>
      </div>
    </div>
    
    